# sars-cov-2-genomes
DataViz Projects on topic of SARS-CoV-2 genomic sequencing, featuring search/matching of mutations (AA Substitutions, Spike, Nuceleotide insertions, deletions, reversions etc).

## gisaid - mutation matches - countries

Filter recent gisaid data by Continent/Country and by Lineage, date range etc. 

Select any mutation(s) from the list to chart the frequency of sequences with that mutation by country, over time. Top 7 countries (by sample volume) shown.

The note at the top-right and grey chart across the bottom show the sample size for all Lineages.

[Link to interactive DataViz](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionc83216eeed0a8b1d1d32)

[![Click to view and interact with the report](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/sars-cov-2-genomes-mutation-matches-countries.png)](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionc83216eeed0a8b1d1d32)


## gisaid - mutation matches - locations

Filter recent gisaid data by Continent/Country/Location and by Lineage, date range etc. 

Select any mutation from the list to chart the frequency of sequences with that mutation by location (state/province/region etc), over time. Top 7 locations (by sample volume) shown.

The note at the top-right and grey chart across the bottom show the sample size for all Lineages.

[Link to interactive DataViz](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionec7dd9b417c8edb0f82d)

[![Click to view and interact with the report](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/sars-cov-2-genomes-mutation-matches-countries.png)](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionec7dd9b417c8edb0f82d)



## gisaid - L2 lineage share log

Filter recent gisaid data by Continent/Country/Location and by Lineage, date range etc. 

Select any mutation from the list to chart the growth of those samples against a "L2" Lineage e.g. BA.2.*.

The note at the top-right and grey chart across the bottom show the sample size for all Lineages.

[Link to interactive DataViz](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSection45c87ba01073b95d9724)

[![Click to view and interact with the report](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/sars-cov-2-genomes-share-L2.png)](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSection45c87ba01073b95d9724)

## gisaid - lineage share log

Filter recent gisaid data by Continent/Country/Location and by Lineage, date range etc. 

Select any mutation from the list to chart the growth of those samples against a Lineage e.g. BA.5.2.

The note at the top-right and grey chart across the bottom show the sample size for all Lineages.

The Lineage growth comparison (log) page was suggested by [Uffe Poulsen](https://twitter.com/uffe1974/status/1485541093257134083?s=20), based to a chart produced by [Alex Selby](https://twitter.com/alexselby1770/status/1485286177104146432?s=20&t=MAjjMu7UC9MWuOUN0_cr1A).

[Link to interactive DataViz](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSection34fa84e04067e4430099)

[![Click to view and interact with the report](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/sars-cov-2-genomes-share.png)](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSection34fa84e04067e4430099)


## gisaid mutation frequency

Filter recent gisaid data by Continent/Country/Location and/or by Lineage etc. Select a required mutation which will apply as a filter.

Then scroll down the table summarising the mutations found, drilling in to any rows of interest. The rows can be drilled by Mutation type (e.g. "Spike"), and specific mutation e.g. S:R346T, Country and Location.  On each row, the count of matching samples is shown, along with a sparkline by Collection date.

Select any row to filter the detailed table at the right.

[Link to interactive DataViz](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionabf46211c8e6288d5a65)

[![Click to view and interact with the report](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/sars-cov-2-genomes-mutation-matches-freq.png)](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionabf46211c8e6288d5a65)

## gisaid map

Visualise the geographical spread of selected mutations. Use the play control at bottom for an animated view of the spread.  Note the animation speed is slow (5 secs per date) to allow for calculation time. Record and speed up before presenting.

Locations are approximate - typically by reporting state/province or country. Bubble sizes are driven by the % of the total set of samples selected. 

[Link to interactive DataViz](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionf4db144cd7f8e5c621ac)

[![Click to view and interact with the report](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/sars-cov-2-genomes-mutation-matches-map.png)](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSectionf4db144cd7f8e5c621ac)


## gisaid geography frequencies

Track the weekly progress of selected mutations for any combination of Continents and Countries. Shows the counts of that lineage vs the overall total, by week collected, also as a %. 

[Link to interactive DataViz](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSection9ee4b4e849ecf1f7e269)

[![Click to view and interact with the report](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/sars-cov-2-genomes-mutation-matches-geography-freq.png)](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=ReportSection9ee4b4e849ecf1f7e269)


## gisaid mutation scatter

Compare the week-on-week growth rates of mutations for any combination of Continents and Countries. Shows the proportion of samples with each mutation for the latest week vs the prior week. Mutations plotted above the diagonal split are becoming more frequent. Hover over any point to view the most frequent lineages with that mutation, and a spark-line showing the frequency growth.

Use the slider controls next to each chart axis to "zoom in" to a zone of interest.

[Link to interactive DataViz](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=2612a1414823bdcad0b2)

[![Click to view and interact with the report](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/sars-cov-2-genomes-mutation-scatter.png)](https://app.powerbi.com/view?r=eyJrIjoiNGY2ZDM3OTQtNTNmZC00Zjc0LTg1N2EtOGVkYmE2ZmI4NmQ5IiwidCI6ImRjMWYwNGY1LWMxZTUtNDQyOS1hODEyLTU3OTNiZTQ1YmY5ZCIsImMiOjEwfQ%3D%3D&pageName=2612a1414823bdcad0b2)


**Summary**

From [gisaid.org](https://gisaid.org) we gather their EpiCoV metadata dataset. For most countries, this dataset is the most complete and up-to-date available.  This can be added to with gisaid search results (e.g. for the most recent samples), downloaded in "Patient status metadata" format.

The AA Substitution values for each gisaid sample can be used as a filter, either independently or together with GISAID's PANGO lineages. Their frequencies and trends over time can be compared on the frequency page.

From [nextclade](https://nextclade.org) we classify the gisaid samples to obtain the nextclade pango lineage, plus the AA & nucleotide insertions, deletions & substitutions, frameshifts and reversions (using the nextclade cli tool). These attributes can be used as a filter for any analysis. Their frequencies and trends over time can be compared on the frequency page.

I'm mainly following the visualisation style I first saw presented by [Trevor Bedford](https://twitter.com/trvrb/status/1392132870064381956?s=20). The main feature are clean, simple line charts, filtered by default to the top 5 countries/locations in the selected data. For each chart point, the frequency of that lineage + mutation in the last 7 days is calculated, always comparing to all the sequencing data available for that country/location.

Other visualisations include interactive drill-down tables to compare mutations, and an interactive map that can be "played" over time - to help understand the geographic spread of any sub-set of samples.

The design for the mutation scatter page was was heavily inspired by the [lungfish dataviz](https://lungfish-science.github.io/wastewater-dashboard/dashboard1.html#scatter-plot-visualization), produced by [Marc Johnson's group](https://x.com/SolidEvidence).

In this project, the data is presented in an interactive data visualisation tool: [Power BI](https://powerbi.microsoft.com). This allows interactive filtering of the data and presentation in multiple formats, for faster easier analysis.

GISAID citation:
Elbe, S., and Buckland-Merrett, G. (2017) Data, disease and diplomacy: GISAID‚Äôs innovative contribution to global health. Global Challenges, 1:33-46. DOI:10.1002/gch2.1018  PMCID: 31565258

[![Developed by a Human, not by AI. Click for more info](https://github.com/Mike-Honey/sars-cov-2-genomes/raw/main/Developed-By-a-Human-Not-By-AI-Badge-white@2x.png)](https://notbyai.fyi)


## ü§ù Support

Contributions, issues, feature requests and sponsorship are all welcome!

Give a ‚≠êÔ∏è if you like this project!
